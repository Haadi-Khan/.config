"use strict";var d=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var M=(t,e)=>{for(var n in e)d(t,n,{get:e[n],enumerable:!0})},O=(t,e,n,c)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of D(e))!F.call(t,i)&&i!==n&&d(t,i,{get:()=>e[i],enumerable:!(c=$(e,i))||c.enumerable});return t};var E=t=>O(d({},"__esModule",{value:!0}),t);var N={};M(N,{default:()=>P});module.exports=E(N);var r=require("@raycast/api"),b=require("react");var m=require("@raycast/api"),s=new m.Cache,u="pomodoro-interval/1.1",f=()=>Math.round(new Date().valueOf()/1e3);function v({parts:t}){return t.reduce((e,n)=>(typeof n.pausedAt<"u"?n.pausedAt-n.startedAt:f()-n.startedAt)+e,0)}function g(t){return v(t)/t.length*100}function k({parts:t}){return!!t[t.length-1].pausedAt}function y(t){let e={type:t,length:J[t],parts:[{startedAt:f()}]};return s.set(u,JSON.stringify(e)),e}function A(){let t=p();if(t){let e=[...t.parts];e[e.length-1].pausedAt=f(),t={...t,parts:e},s.set(u,JSON.stringify(t))}return t}function T(){let t=p();if(t){let e=[...t.parts,{startedAt:f()}];t={...t,parts:e},s.set(u,JSON.stringify(t))}return t}function h(){s.remove(u)}function p(){let t=s.get(u);if(t)return JSON.parse(t)}var a=(0,m.getPreferenceValues)(),J={focus:parseInt(a.focusIntervalDuration)*60,"short-break":parseInt(a.shortBreakIntervalDuration)*60,"long-break":parseInt(a.longBreakIntervalDuration)*60};function x(t){if(t<=0)return"00:00";let e=Math.floor(t/60),n=t%60;return`${e<10?`0${e}`:e}:${n<10?`0${n}`:n}`}var o=require("react/jsx-runtime"),C={light:"#000000",dark:"#FFFFFF",adjustContrast:!1};function P(){let[t,e]=(0,b.useState)(p());if(t&&g(t)>=100){try{(0,r.launchCommand)({name:"pomodoro-control-timer",type:r.LaunchType.UserInitiated,context:{currentInterval:t}})}catch(l){console.error(l)}h()}function n(l){e(y(l))}function c(){e(A())}function i(){e(T())}function B(){h(),e(void 0)}let I;I={source:"tomato-0.png",tintColor:C},t&&(I={source:`tomato-${100-Math.floor(g(t)/10)*10}.png`,tintColor:C});let S=a.enableTimeOnMenuBar?t?x(t.length-v(t)):"--:--":void 0;return(0,o.jsx)(r.MenuBarExtra,{icon:I,title:S,tooltip:"Pomodoro",children:t?(0,o.jsxs)(o.Fragment,{children:[k(t)?(0,o.jsx)(r.MenuBarExtra.Item,{title:"Continue",icon:r.Icon.Play,onAction:i,shortcut:{modifiers:["cmd"],key:"c"}}):(0,o.jsx)(r.MenuBarExtra.Item,{title:"Pause",icon:r.Icon.Pause,onAction:c,shortcut:{modifiers:["cmd"],key:"p"}}),(0,o.jsx)(r.MenuBarExtra.Item,{title:"Reset",icon:r.Icon.Stop,onAction:B,shortcut:{modifiers:["cmd"],key:"r"}})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.MenuBarExtra.Item,{title:"Focus",subtitle:`${a.focusIntervalDuration}:00`,icon:"\u{1F3AF}",onAction:()=>n("focus"),shortcut:{modifiers:["cmd"],key:"f"}}),(0,o.jsx)(r.MenuBarExtra.Item,{title:"Short Break",subtitle:`${a.shortBreakIntervalDuration}:00`,icon:"\u{1F9D8}\u200D\u2642\uFE0F",onAction:()=>n("short-break"),shortcut:{modifiers:["cmd"],key:"s"}}),(0,o.jsx)(r.MenuBarExtra.Item,{title:"Long Break",subtitle:`${a.longBreakIntervalDuration}:00`,icon:"\u{1F6B6}",onAction:()=>n("long-break"),shortcut:{modifiers:["cmd"],key:"l"}})]})})}
